# TTS Voice Wizard

<div align="center">

**VRChat向けの高機能音声合成・音声認識アプリケーション**

[![.NET 6.0](https://img.shields.io/badge/.NET-6.0-blue.svg)](https://dotnet.microsoft.com/download/dotnet/6.0)
[![Windows](https://img.shields.io/badge/Platform-Windows-blue.svg)](https://www.microsoft.com/windows)
[![VRChat](https://img.shields.io/badge/Integration-VRChat%20OSC-green.svg)](https://docs.vrchat.com/docs/osc-overview)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

</div>

---

## 📖 目次

1. [概要](#概要)
2. [主な機能](#主な機能)
3. [対応TTSエンジン](#対応ttsエンジン)
4. [対応音声認識エンジン](#対応音声認識エンジン)
5. [システム要件](#システム要件)
6. [インストール方法](#インストール方法)
7. [初期設定](#初期設定)
8. [基本的な使い方](#基本的な使い方)
9. [詳細設定](#詳細設定)
10. [VRChat連携](#vrchat連携)
11. [外部サービス連携](#外部サービス連携)
12. [音声プリセット](#音声プリセット)
13. [翻訳機能](#翻訳機能)
14. [OBS連携](#obs連携)
15. [トラブルシューティング](#トラブルシューティング)
16. [よくある質問](#よくある質問)
17. [開発者向け情報](#開発者向け情報)


---

## 概要

TTS Voice Wizardは、VRChat（バーチャルリアリティチャット）ユーザー向けに開発された、高度な音声合成（Text-to-Speech）および音声認識（Speech-to-Text）機能を提供するWindowsデスクトップアプリケーションです。

本アプリケーションは、OSC（Open Sound Control）プロトコルを使用してVRChatと直接連携し、あなたの音声をリアルタイムでテキストに変換し、さらにそのテキストを様々な音声エンジンを使用して音声に変換することができます。これにより、VRChat内でのコミュニケーションがより豊かで多様なものになります。

### 主なユースケース

- **音声チャットの代替**: マイクを使用せずに、テキスト入力から音声を生成してVRChat内で会話
- **リアルタイム文字起こし**: あなたの発言をリアルタイムでテキスト化し、VRChatアバターの上に表示
- **多言語コミュニケーション**: 翻訳機能を使用して、異なる言語を話すユーザーとのコミュニケーションを支援
- **アクセシビリティ支援**: 聴覚障害者や発話困難な方のコミュニケーションを支援
- **配信向け機能**: OBSとの連携により、配信画面にリアルタイム字幕を表示
- **エンターテインメント**: カスタムボイスやキャラクターボイスを使用した楽しいコミュニケーション

### プロジェクト構成

本プロジェクトは以下の2つの主要なコンポーネントで構成されています：

1. **OSCVRCWiz**: メインのWindows Formsアプリケーション（.NET 6.0）
2. **MoonbaseVoices**: 追加の音声合成機能を提供するサポートライブラリ

---

## 主な機能

TTS Voice Wizardは、以下のような豊富な機能を提供しています：

### 🎤 音声認識機能

- **リアルタイム音声認識**: マイクからの音声をリアルタイムでテキストに変換
- **複数の認識エンジン対応**: Whisper、Vosk、Azure、ElevenLabsなど多様なエンジンをサポート
- **多言語認識**: 100以上の言語に対応した音声認識が可能
- **カスタム語彙**: 特定の単語やフレーズの認識精度を向上させるためのカスタム辞書機能
- **ノイズ除去**: WebRTC VAD（Voice Activity Detection）による高精度な音声検出

### 🔊 音声合成機能

- **15種類以上のTTSエンジン**: Azure、AWS Polly、Google、ElevenLabs、OpenAI、TikTokなど
- **500以上の音声オプション**: 様々な言語、性別、スタイルの音声から選択可能
- **音声カスタマイズ**: ピッチ、速度、音量の調整が可能
- **感情表現**: 一部のエンジンでは感情を込めた音声生成が可能
- **SSMLサポート**: 高度な音声制御のためのSSML（Speech Synthesis Markup Language）対応

### 🎮 VRChat連携

- **OSCプロトコル対応**: VRChatのOSC機能を使用した直接連携
- **チャットボックス表示**: 音声認識結果やテキストをVRChat内のチャットボックスに表示
- **アバターパラメータ制御**: 音声入力に応じてアバターのパラメータを動的に変更
- **KAT対応**: Killfrenzy Avatar Textシステムとの互換性

### 🌐 翻訳機能

- **リアルタイム翻訳**: 音声認識結果を自動的に他の言語に翻訳
- **DeepL API対応**: 高品質な翻訳のためのDeepL APIサポート
- **多言語対応**: 26以上の言語間での翻訳が可能

### 📺 配信者向け機能

- **OBS連携**: テキストファイル出力によるOBSとの簡単な連携
- **リアルタイム字幕**: 配信画面にリアルタイムで字幕を表示
- **メディア情報表示**: 再生中の音楽情報をVRChatチャットボックスに表示

### ❤️ 外部サービス連携

- **Spotify連携**: 再生中の楽曲情報をVRChat内に表示
- **Pulsoid連携**: 心拍数モニタリングとVRChat表示
- **ChatGPT連携**: AIアシスタント機能の統合
- **Windows Media連携**: システムメディア情報の取得と表示

### ⚙️ その他の機能

- **音声プリセット**: よく使う音声設定を保存・呼び出し
- **ホットキー対応**: キーボードショートカットによる操作
- **自動更新**: アプリケーションの自動更新機能
- **多言語UI**: 複数言語に対応したユーザーインターフェース
- **テーマカスタマイズ**: UIテーマの変更が可能

---

## 対応TTSエンジン

TTS Voice Wizardは、以下の15種類以上の音声合成エンジンに対応しています：

### クラウド型TTSエンジン

#### 1. Microsoft Azure Cognitive Services

**概要**: Microsoftが提供する高品質なクラウドベースの音声合成サービスです。

**特徴**:
- 400以上の音声オプション
- 130以上の言語に対応
- ニューラル音声による自然な発話
- SSMLによる高度な音声制御
- 感情表現（cheerful, sad, angryなど）

**必要な設定**:
- Azure Cognitive Servicesのサブスクリプションキー
- リージョン設定

**料金**: 無料枠あり（毎月50万文字まで）、有料プランは100万文字あたり$1〜

#### 2. Amazon Polly

**概要**: Amazon Web Servicesが提供する音声合成サービスです。

**特徴**:
- 60以上の音声オプション
- 30以上の言語に対応
- ニューラル音声とスタンダード音声の選択
- リアルタイム音声ストリーミング
- 音声マーク（viseme、word）のサポート

**必要な設定**:
- AWS Access Key ID
- AWS Secret Access Key
- AWSリージョン

**料金**: 無料枠あり（12ヶ月間、毎月500万文字まで）

#### 3. Google Cloud Text-to-Speech

**概要**: Googleが提供するWaveNetテクノロジーを使用した高品質音声合成サービスです。

**特徴**:
- 380以上の音声オプション
- 40以上の言語に対応
- WaveNet音声による極めて自然な発話
- SSMLサポート

**必要な設定**:
- Google Cloud APIキー
- サービスアカウント認証情報

**料金**: 無料枠あり（毎月100万文字まで）

#### 4. ElevenLabs

**概要**: 最新のAI技術を使用した、非常にリアルな音声合成サービスです。

**特徴**:
- プロフェッショナルグレードの音声品質
- カスタム音声のクローニング
- 感情豊かな表現
- 多言語対応

**必要な設定**:
- ElevenLabs APIキー

**料金**: 無料プランあり（毎月10,000文字まで）

#### 5. OpenAI TTS

**概要**: ChatGPTで知られるOpenAIが提供する音声合成APIです。

**特徴**:
- 6種類の自然な音声
- 高品質なニューラル音声
- シンプルなAPI

**必要な設定**:
- OpenAI APIキー

**料金**: 1,000文字あたり$0.015〜

#### 6. TikTok TTS

**概要**: TikTokアプリで使用されている音声合成エンジンを利用したサービスです。

**特徴**:
- 無料で利用可能
- エンターテインメント向けの楽しい音声
- キャラクターボイス多数
- APIキー不要

**料金**: 無料

### 7. UberDuck

**概要**: AIを使用したカスタムボイスとセレブリティボイスを提供するサービスです。

**特徴**:
- 5,000以上のAI音声
- セレブリティ音声のクローン
- アニメキャラクター音声

**必要な設定**:
- UberDuck APIキー
- UberDuck Secret Key

**料金**: 無料プランあり

### 8. IBM Watson Text to Speech

**概要**: IBMが提供するエンタープライズグレードの音声合成サービスです。

**特徴**:
- 高品質なニューラル音声
- 複数言語対応
- エンタープライズ向けの信頼性

**必要な設定**:
- IBM Watson APIキー
- サービスURL

**料金**: 無料枠あり（毎月10,000文字まで）

### 9. Deepgram TTS

**概要**: 高速で低遅延の音声合成サービスです。

**特徴**:
- 低遅延音声生成
- リアルタイムアプリケーション向け

**必要な設定**:
- Deepgram APIキー

### 10. TTS Monster

**概要**: ストリーマー向けに最適化された音声合成サービスです。

**特徴**:
- Twitch連携
- カスタム音声
- 配信向け機能

**必要な設定**:
- TTS Monster APIキー

### ローカル型TTSエンジン

#### 11. Windows System Speech

**概要**: Windowsに標準搭載されている音声合成エンジンです。

**特徴**:
- インターネット接続不要
- 完全無料
- 低遅延
- プライバシー重視

**必要な設定**: なし（Windowsの音声がインストールされていれば使用可能）

**対応言語**: Windowsにインストールされている音声パックに依存

#### 12. Moonbase TTS（DECTalk）

**概要**: 1980年代から使用されているレトロな音声合成エンジン（DECTalk）を現代のシステムで使用できるようにしたものです。

**特徴**:
- インターネット接続不要
- レトロなロボット音声
- 低リソース消費
- 完全無料

**必要な設定**: なし

#### 13. GLaDOS TTS

**概要**: ゲーム「Portal」シリーズに登場するAIキャラクター「GLaDOS」風の音声を生成します。

**特徴**:
- ユニークなロボット音声
- エンターテインメント向け

### 14. VoiceForge TTS

**概要**: カスタムキャラクター音声を提供するサービスです。

**特徴**:
- 多様なキャラクター音声
- カスタマイズ可能

### 15. Voice Wizard Pro TTS

**概要**: TTS Voice Wizardのプレミアムサービスとして提供される独自のTTSエンジンです。

**特徴**:
- 高品質音声
- 追加機能

---

## 対応音声認識エンジン

TTS Voice Wizardは、以下の音声認識エンジンに対応しています：

### オフライン対応エンジン

#### 1. Whisper（OpenAI）

**概要**: OpenAIが開発した最先端の音声認識AIモデルです。

**特徴**:
- 100以上の言語に対応
- 高い認識精度
- オフライン動作可能
- 翻訳機能内蔵
- 多様なモデルサイズ（tiny, base, small, medium, large）

**モデルサイズと精度**:
| モデル | サイズ | VRAM必要量 | 相対精度 |
|--------|--------|------------|----------|
| tiny | 39MB | ~1GB | 低 |
| base | 74MB | ~1GB | 中低 |
| small | 244MB | ~2GB | 中 |
| medium | 769MB | ~5GB | 中高 |
| large | 1550MB | ~10GB | 高 |

**必要な設定**: 
- Whisperモデルファイルのダウンロード
- 使用するモデルサイズの選択

**料金**: 完全無料（オープンソース）

#### 2. Vosk

**概要**: オフラインで動作する軽量な音声認識エンジンです。

**特徴**:
- 完全オフライン動作
- 低リソース消費
- 20以上の言語対応
- リアルタイム認識
- Raspberry Piでも動作可能

**必要な設定**:
- Voskモデルファイルのダウンロード
- 使用する言語モデルの選択

**料金**: 完全無料（オープンソース）

#### 3. Windows System Speech Recognition

**概要**: Windowsに標準搭載されている音声認識エンジンです。

**特徴**:
- インターネット接続不要
- 即座に使用可能
- Windows設定で言語追加可能

**必要な設定**: なし

**料金**: 無料（Windows標準機能）

### クラウド型エンジン

#### 4. Azure Speech Services

**概要**: Microsoftが提供する高精度なクラウドベースの音声認識サービスです。

**特徴**:
- 100以上の言語と方言に対応
- 高い認識精度
- リアルタイム音声認識
- カスタム音声モデル作成可能
- 話者識別機能

**必要な設定**:
- Azure Cognitive Servicesのサブスクリプションキー
- リージョン設定

**料金**: 無料枠あり（毎月5時間まで）

#### 5. ElevenLabs Speech Recognition

**概要**: ElevenLabsが提供する音声認識サービスです。

**特徴**:
- 高精度認識
- ElevenLabs TTSとの統合

**必要な設定**:
- ElevenLabs APIキー

#### 6. Voice Wizard Pro Recognition

**概要**: TTS Voice Wizardのプレミアムサービスとして提供される独自の音声認識エンジンです。

**特徴**:
- 高精度認識
- 追加機能

### 7. Web Captioner

**概要**: Webベースのキャプションサービスとの連携機能です。

**特徴**:
- ブラウザベースの音声認識
- 無料で使用可能

### 8. テキストファイルリーダー

**概要**: テキストファイルからの入力を監視し、変更があった際に読み上げる機能です。

**特徴**:
- 外部アプリケーションとの連携
- ファイル監視による自動検出

---

## システム要件

TTS Voice Wizardを使用するには、以下のシステム要件を満たす必要があります：

### 最小要件

| 項目 | 要件 |
|------|------|
| OS | Windows 10 バージョン 1809 以降 |
| プロセッサ | Intel Core i3 または同等のプロセッサ |
| メモリ | 4GB RAM |
| ストレージ | 500MB の空き容量 |
| グラフィックス | DirectX 11 対応 |
| インターネット | クラウドTTS/STT使用時に必要 |
| .NET | .NET 6.0 ランタイム |

### 推奨要件

| 項目 | 要件 |
|------|------|
| OS | Windows 11 |
| プロセッサ | Intel Core i5 または同等以上 |
| メモリ | 8GB RAM 以上 |
| ストレージ | 2GB の空き容量（Whisperモデル用） |
| グラフィックス | CUDA対応GPU（Whisper GPU加速用） |
| インターネット | 安定した接続（クラウドサービス用） |
| マイク | 高品質USB/XLRマイク |

### Whisper使用時の追加要件

Whisperモデルを使用する場合、以下の追加リソースが必要です：

| モデル | 推奨VRAM | 推奨RAM |
|--------|---------|---------|
| tiny | 1GB | 4GB |
| base | 1GB | 4GB |
| small | 2GB | 6GB |
| medium | 5GB | 8GB |
| large | 10GB | 16GB |

---

## インストール方法

### 方法1: リリースバイナリからのインストール（推奨）

1. **GitHubリリースページにアクセス**
   
   最新のリリースをGitHubリリースページからダウンロードします。

2. **ZIPファイルの展開**
   
   ダウンロードしたZIPファイルを任意のフォルダに展開します。
   
   ```
   例: C:\Programs\TTSVoiceWizard
   ```

3. **アプリケーションの起動**
   
   展開したフォルダ内の `TTSVoiceWizard.exe` をダブルクリックして起動します。

4. **初回起動時の設定**
   
   初回起動時には、Windows Defender SmartScreenの警告が表示される場合があります。
   「詳細情報」をクリックし、「実行」を選択してください。

### 方法2: ソースコードからのビルド

開発者やカスタマイズを行いたいユーザー向けの方法です。

#### 前提条件

- Visual Studio 2022 または JetBrains Rider
- .NET 6.0 SDK
- Windows 10 SDK (10.0.22000.0)

#### ビルド手順

1. **リポジトリのクローン**

   ```bash
   git clone https://github.com/VRCWizard/TTS-Voice-Wizard.git
   cd TTS-Voice-Wizard
   ```

2. **NuGetパッケージの復元**

   ```bash
   dotnet restore
   ```

3. **プロジェクトのビルド**

   ```bash
   dotnet build --configuration Release
   ```

4. **アプリケーションの実行**

   ```bash
   dotnet run --project OSCVRCWiz
   ```

#### Taskfileを使用したビルド（推奨）

本プロジェクトにはTaskfileが含まれています。Taskfileを使用することで、ビルドプロセスを簡略化できます。

```bash
# Taskのインストール（未インストールの場合）
# https://taskfile.dev/installation/

# ビルドの実行
task build

# アプリケーションの実行
task run
```

---

## 初期設定

TTS Voice Wizardを初めて使用する際の基本的な設定手順を説明します。

### 1. オーディオデバイスの設定

1. アプリケーションを起動します
2. メイン画面の「Settings」タブを開きます
3. 「Audio Devices」セクションで以下を設定します：
   - **入力デバイス**: 使用するマイクを選択
   - **出力デバイス**: TTS音声を再生するデバイスを選択
   - **VRChat Audio**: VRChatで使用する仮想オーディオデバイス（VB-Cable等）

### 2. 音声認識エンジンの設定

1. 「Speech」タブを開きます
2. 「Recognition Engine」ドロップダウンから使用するエンジンを選択：
   
   **Whisper（推奨）の場合**:
   - モデルサイズを選択（小さいほど高速、大きいほど高精度）
   - 「Download Model」ボタンでモデルをダウンロード
   - 認識言語を設定

   **Voskの場合**:
   - 「Download Model」から言語モデルをダウンロード
   - 使用する言語を選択

   **Azure/クラウドサービスの場合**:
   - APIキーを入力
   - リージョンを設定
   - 認識言語を選択

### 3. TTSエンジンの設定

1. 「TTS」タブを開きます
2. 「TTS Engine」ドロップダウンから使用するエンジンを選択
3. 各エンジンに必要な設定を行います：

   **Azure TTS**:
   - Subscription Key
   - Region
   - 音声の選択

   **TikTok TTS**:
   - 音声の選択のみ（APIキー不要）

   **Windows System Speech**:
   - インストールされている音声から選択

### 4. VRChat連携の設定

1. 「VRChat」タブを開きます
2. OSC設定を確認：
   - **OSC Port (Receive)**: 9001（デフォルト）
   - **OSC Port (Send)**: 9000（デフォルト）
   - **OSC IP Address**: 127.0.0.1（ローカル）

3. VRChat側でOSCを有効化：
   - VRChatのアクションメニューを開く
   - Options → OSC → Enabled をオンにする

### 5. 動作確認

1. 「Speech」タブで「Start Listening」ボタンをクリック
2. マイクに向かって話しかける
3. 認識されたテキストが表示されることを確認
4. 「TTS」タブでテキストを入力し、「Speak」ボタンをクリック
5. TTSエンジンから音声が再生されることを確認
6. VRChatを起動し、チャットボックスにテキストが表示されることを確認

---

## 基本的な使い方

TTS Voice Wizardの基本的な操作方法を説明します。

### 音声認識の開始

1. メイン画面の「Speech」タブを選択
2. 使用するマイクが正しく選択されていることを確認
3. 「Start Listening」ボタンをクリック
4. マイクに向かって話すと、リアルタイムでテキストに変換されます

### テキスト読み上げ（TTS）

**手動入力から読み上げ**:
1. 「TTS」タブを選択
2. テキスト入力ボックスに読み上げたい文章を入力
3. 「Speak」ボタンをクリック

**音声認識結果の自動読み上げ**:
1. 「Speech」タブで「Auto TTS」オプションを有効化
2. 音声認識を開始
3. 認識されたテキストが自動的にTTSで読み上げられます

### クイックタイプ機能

よく使うフレーズを登録して、ワンクリックで送信・読み上げができます：

1. 「Quick Type」セクションでフレーズを登録
2. ホットキーまたはボタンで瞬時にフレーズを送信
3. 最大8つのクイックタイプスロットを使用可能

### VRChatチャットボックスへの送信

1. VRChatでOSCが有効になっていることを確認
2. TTS Voice Wizardで音声認識またはテキスト入力
3. テキストは自動的にVRChatのチャットボックスに送信されます

### 音声の切り替え

1. 「TTS」タブの音声選択ドロップダウンを使用
2. 言語、性別、スタイルで絞り込み可能
3. 音声プリセットを作成して素早く切り替え

---

## 詳細設定

より高度な設定オプションについて説明します。

### 音声品質設定

**ピッチ調整**:
- TTSの音声のピッチ（高さ）を調整
- 範囲: -100% 〜 +100%
- 正の値で高い声、負の値で低い声になります

**速度調整**:
- 読み上げ速度を調整
- 範囲: 0.25x 〜 4.0x
- 通常は0.8x〜1.2xが聞き取りやすい

**音量調整**:
- TTS音声の音量を調整
- 範囲: 0% 〜 100%

### 認識設定

**VAD（Voice Activity Detection）**:
- 音声検出の感度を調整
- 値が高いほど無音時間が長くても認識を継続
- 値が低いほど素早く認識を確定

**言語設定**:
- 主要認識言語の設定
- 自動言語検出の有効/無効
- 複数言語のサポート設定

### ネットワーク設定

**OSC設定**:
- 送信ポート（デフォルト: 9000）
- 受信ポート（デフォルト: 9001）
- IPアドレス（ローカル: 127.0.0.1）

**WebSocket設定**:
- 外部アプリケーション連携用のWebSocketサーバー
- ポート設定とセキュリティオプション

### UI設定

**テーマ**:
- ダークモード/ライトモードの切り替え
- カスタムカラーテーマ

**ウィンドウ動作**:
- 最小化時のシステムトレイ格納
- スタートアップ時の自動起動
- ウィンドウサイズの記憶

---

## VRChat連携

TTS Voice WizardとVRChatの連携について詳しく説明します。

### OSCの基本設定

VRChatはOpen Sound Control（OSC）プロトコルを使用して外部アプリケーションと通信します。

**VRChat側の設定**:
1. VRChatを起動
2. アクションメニューを開く（デスクトップ: Escキー、VR: メニューボタン）
3. Options → OSC → Enable を選択
4. OSCが有効になったことを確認

**TTS Voice Wizard側の設定**:
1. 「VRChat」タブを開く
2. OSC IPが `127.0.0.1` であることを確認
3. 送信ポートが `9000`、受信ポートが `9001` であることを確認

### チャットボックス表示

VRChatのチャットボックスにテキストを表示する機能です：

**設定オプション**:
- **Character Limit**: 表示文字数の制限（VRChatの制限: 144文字）
- **Typing Indicator**: タイピング中インジケーターの表示
- **Send Button**: 手動送信ボタンの有効化
- **Auto Send**: 認識完了時の自動送信

**表示モード**:
- **Normal**: 通常のチャットボックス表示
- **KAT**: Killfrenzy Avatar Textシステム使用時

### アバターパラメータ制御

OSCを使用してアバターのパラメータを制御できます：

**対応パラメータ**:
- 表情パラメータ
- 音声ビジュアライザー
- カスタムパラメータ

**設定方法**:
1. アバターのOSCパラメータ名を確認
2. TTS Voice Wizardでパラメータマッピングを設定
3. 音声入力や認識結果に応じてパラメータが自動変更

### トラブルシューティング（VRChat連携）

**テキストが表示されない場合**:
1. VRChatでOSCが有効になっているか確認
2. ファイアウォールがOSCポートをブロックしていないか確認
3. TTS Voice WizardのOSCポート設定を確認
4. VRChatを再起動

**遅延がある場合**:
1. ローカル接続（127.0.0.1）を使用しているか確認
2. 他のOSCアプリケーションが競合していないか確認

---

## 外部サービス連携

TTS Voice Wizardは様々な外部サービスと連携できます。

### Spotify連携

再生中の楽曲情報をVRChatチャットボックスに表示できます。

**設定手順**:
1. Spotify Developer Dashboardでアプリを作成
2. Client IDとClient Secretを取得
3. TTS Voice WizardのSpotify設定に入力
4. 認証を完了

**表示オプション**:
- 曲名
- アーティスト名
- アルバム名
- 再生時間

### Pulsoid（心拍数モニタリング）連携

心拍数モニターからのデータをVRChatに表示できます。

**対応デバイス**:
- Pulsoidアプリ対応の心拍数モニター
- Apple Watch
- Fitbit
- Polar

**設定手順**:
1. Pulsoidアカウントを作成
2. APIトークンを取得
3. TTS Voice WizardのPulsoid設定に入力

**表示形式**:
- 現在の心拍数
- 最大/最小心拍数
- 平均心拍数

### ChatGPT連携

OpenAI ChatGPT APIを使用したAIアシスタント機能です。

**機能**:
- 音声入力からAIへの質問
- AIの応答をTTSで読み上げ
- 会話履歴の保持

**設定**:
1. OpenAI APIキーを取得
2. TTS Voice WizardのChatGPT設定に入力
3. モデル（GPT-3.5/GPT-4）を選択

### Windows Media連携

Windowsで再生中のメディア情報を取得して表示します。

**対応アプリ**:
- Spotify（デスクトップアプリ）
- Windows Media Player
- VLC Media Player
- その他のWindowsメディアコントロール対応アプリ

**設定**:
- 自動検出（追加設定不要）

---

## 音声プリセット

よく使う音声設定を音声プリセットとして保存・管理できます。

### プリセットの作成

1. TTSの音声設定を完了（エンジン、音声、ピッチ、速度など）
2. 「Voice Presets」セクションで「Save Preset」をクリック
3. プリセット名を入力して保存

### プリセットの使用

1. 「Voice Presets」ドロップダウンからプリセットを選択
2. 設定が即座に適用されます

### プリセットのエクスポート/インポート

**エクスポート**:
1. 「Export Presets」ボタンをクリック
2. 保存先を選択
3. JSONファイルとしてエクスポート

**インポート**:
1. 「Import Presets」ボタンをクリック
2. エクスポートしたJSONファイルを選択
3. プリセットがインポートされます

### ホットキーによるプリセット切り替え

キーボードショートカットでプリセットを切り替えられます：

1. プリセットの設定でホットキーを割り当て
2. 割り当てたキーを押すとプリセットが切り替わります

---

## 翻訳機能

TTS Voice Wizardには、リアルタイム翻訳機能が搭載されています。

### 対応翻訳API

**DeepL API**:
- 高品質な翻訳
- 26言語対応
- 無料枠: 月50万文字

### 翻訳の設定

1. 「Translation」タブを開く
2. 使用する翻訳APIを選択
3. APIキーを入力
4. ソース言語と翻訳先言語を設定

### 翻訳モード

**自動翻訳モード**:
- 音声認識結果を自動的に翻訳
- 翻訳結果をVRChatに送信

**手動翻訳モード**:
- テキスト入力から翻訳
- 翻訳結果を確認後に送信

### 対応言語

DeepL APIで対応している言語：

| 言語 | コード |
|------|--------|
| 日本語 | JA |
| 英語（アメリカ） | EN-US |
| 英語（イギリス） | EN-GB |
| ドイツ語 | DE |
| フランス語 | FR |
| スペイン語 | ES |
| 中国語（簡体字） | ZH |
| 韓国語 | KO |
| ポルトガル語 | PT |
| イタリア語 | IT |
| オランダ語 | NL |
| ポーランド語 | PL |
| ロシア語 | RU |
| など |  |

---

## OBS連携

TTS Voice WizardはOBS Studioとの連携機能を備えています。

### テキストファイル連携

TTS Voice Wizardは認識結果をテキストファイルに出力します。OBSのテキストソースでこのファイルを読み込むことで、配信画面にリアルタイム字幕を表示できます。

**出力ファイル**:
- `OBSText.txt`: 認識されたテキスト
- `OBSTextTranslated.txt`: 翻訳されたテキスト
- `MediaIntegration.txt`: メディア情報
- `TranscriptionOnly.txt`: 文字起こし専用テキスト

### OBSでの設定

1. OBSで「テキスト（GDI+）」ソースを追加
2. 「ファイルからテキストを読み取る」を有効化
3. TTS Voice Wizardの出力ファイルを選択
4. 表示位置とスタイルを調整

### スタイリングのヒント

- フォントサイズ: 24〜48px推奨
- 背景色: 半透明の黒（読みやすさ向上）
- テキスト色: 白またはコントラストの高い色
- ワードラップを有効化

---

## トラブルシューティング

よくある問題とその解決方法を説明します。

### 音声認識が動作しない

**原因1: マイクが認識されていない**
- 解決策: Windowsの設定でマイクのアクセス権限を確認
- 設定 → プライバシー → マイク → アプリにマイクへのアクセスを許可

**原因2: モデルファイルがダウンロードされていない**
- 解決策: Whisper/Voskのモデルをダウンロード
- 「Download Model」ボタンをクリック

**原因3: 入力デバイスが正しく選択されていない**
- 解決策: オーディオ設定で正しいマイクを選択

### TTSが音声を再生しない

**原因1: 出力デバイスが正しく設定されていない**
- 解決策: オーディオ設定で正しい出力デバイスを選択

**原因2: APIキーが無効**
- 解決策: クラウドTTSサービスのAPIキーを確認
- API制限や課金状況を確認

**原因3: インターネット接続の問題**
- 解決策: ネットワーク接続を確認
- ファイアウォール設定を確認

### VRChatにテキストが表示されない

**原因1: OSCが有効になっていない**
- 解決策: VRChatでOSCを有効化
- アクションメニュー → Options → OSC → Enable

**原因2: ポートの競合**
- 解決策: 他のOSCアプリケーションを終了
- ポート番号を変更

**原因3: ファイアウォールによるブロック**
- 解決策: Windowsファイアウォールの例外にTTS Voice Wizardを追加

### アプリケーションがクラッシュする

**原因1: .NETランタイムの問題**
- 解決策: .NET 6.0ランタイムを再インストール

**原因2: 破損した設定ファイル**
- 解決策: 設定ファイルを削除して初期化
- `%APPDATA%\TTSVoiceWizard` フォルダを削除

**原因3: 互換性のないDLL**
- 解決策: アプリケーションを再インストール

### パフォーマンスの問題

**CPU使用率が高い**:
- Whisperモデルサイズを小さくする（large → medium → small）
- GPU加速を有効化（CUDA対応GPUが必要）

**メモリ使用量が多い**:
- 使用していない機能を無効化
- 小さいモデルサイズを使用

---

## よくある質問

### 一般的な質問

**Q: TTS Voice Wizardは無料ですか？**

A: はい、TTS Voice Wizard自体は無料でオープンソースです。ただし、一部のクラウドサービス（Azure、AWS、ElevenLabsなど）は、無料枠を超えると課金が発生する場合があります。

**Q: どのTTSエンジンがおすすめですか？**

A: 用途によります：
- 無料で始めたい → TikTok TTS、Windows System Speech
- 高品質を求める → Azure、ElevenLabs
- オフラインで使いたい → Windows System Speech、Moonbase TTS

**Q: どの音声認識エンジンがおすすめですか？**

A: 
- 高精度・オフライン → Whisper（large/mediumモデル）
- 低スペックPC → Vosk、Windows System Speech
- 最高精度・オンライン → Azure Speech Services

**Q: VRChat以外でも使えますか？**

A: はい、OSC対応のアプリケーションや、テキストファイル出力を利用して他のアプリケーションとも連携できます。OBS連携による配信字幕表示も人気の使い方です。

### 技術的な質問

**Q: 仮想オーディオケーブルは必要ですか？**

A: VRChat内でTTS音声を他のプレイヤーに聞かせたい場合は必要です。VB-Cable、VoiceMeeterなどの仮想オーディオデバイスを使用してTTS出力をマイク入力にルーティングします。

**Q: 複数言語を同時に認識できますか？**

A: Whisperは多言語認識に対応していますが、精度を最大化するには主要言語を設定することをおすすめします。

**Q: APIキーはどこで取得できますか？**

A: 各サービスの開発者ポータルで取得できます：
- Azure: portal.azure.com
- AWS: aws.amazon.com
- ElevenLabs: elevenlabs.io
- OpenAI: platform.openai.com
- DeepL: deepl.com/pro-api

---

## 開発者向け情報

TTS Voice Wizardの開発に興味がある方向けの情報です。

### プロジェクト構造

```
TTS-Voice-Wizard/
├── OSCVRCWiz/                    # メインアプリケーション
│   ├── Assets/                   # リソースファイル（言語、音声、サウンド）
│   ├── Output/                   # 出力ファイル用ディレクトリ
│   ├── Properties/               # アプリケーションプロパティ
│   ├── RJControls/               # カスタムUIコントロール
│   ├── Resources/                # 埋め込みリソース
│   ├── Services/                 # サービスレイヤー
│   │   ├── Integrations/         # 外部サービス連携
│   │   │   ├── Heartrate/        # 心拍数連携
│   │   │   └── Media/            # メディア連携
│   │   ├── Speech/               # 音声サービス
│   │   │   ├── Speech Recognition/ # 音声認識エンジン
│   │   │   ├── TextToSpeech/     # 音声合成エンジン
│   │   │   │   └── TTSEngines/   # 各種TTSエンジン実装
│   │   │   └── TranslationAPIs/  # 翻訳API
│   │   └── Text/                 # テキスト処理
│   ├── Settings/                 # 設定管理
│   ├── Program.cs                # エントリーポイント
│   ├── VoiceWizardWindow.cs      # メインウィンドウ
│   └── OSCVRCWiz.csproj          # プロジェクトファイル
├── MoonbaseVoices/               # サポートライブラリ（DECTalk音声）
│   ├── Program.cs
│   ├── AudioController.cs
│   └── MoonbaseVoices.csproj
├── OSCVRCWiz.sln                 # ソリューションファイル
├── Taskfile.yml                  # タスクランナー設定
└── common.props                  # 共通ビルドプロパティ
```

### 使用技術・ライブラリ

**フレームワーク**:
- .NET 6.0
- Windows Forms

**主要NuGetパッケージ**:
| パッケージ | 用途 |
|-----------|------|
| Microsoft.CognitiveServices.Speech | Azure音声サービス |
| AWSSDK.Polly | Amazon Polly TTS |
| NAudio | オーディオ処理 |
| Vosk | オフライン音声認識 |
| DeepL.net | DeepL翻訳API |
| SpotifyAPI.Web | Spotify連携 |
| WebRtcVadSharp | 音声検出 |
| ChatGPT.Net | ChatGPT連携 |
| FontAwesome.Sharp | UIアイコン |
| Autoupdater.NET.Official | 自動更新 |

**ネイティブDLL**:
- CoreOSC.dll: OSCプロトコル実装
- WhisperNet.dll: Whisper音声認識
- Whisper.dll: Whisperネイティブライブラリ
- SoundTouch_x64.dll: オーディオ処理

### ビルド環境のセットアップ

1. **Visual Studio 2022のインストール**
   - ASP.NETおよびWeb開発ワークロード
   - .NETデスクトップ開発ワークロード

2. **Windows SDKのインストール**
   - Windows 10 SDK (10.0.22000.0)

3. **リポジトリのクローン**
   ```bash
   git clone https://github.com/VRCWizard/TTS-Voice-Wizard.git
   ```

4. **ソリューションを開く**
   ```bash
   OSCVRCWiz.sln
   ```

5. **NuGetパッケージの復元**
   - Visual Studioで自動的に復元されます

### コーディング規約

- C# 10.0の機能を使用
- nullable参照型を有効化
- XMLドキュメントコメントでPublic APIを文書化
- 非同期/await パターンでI/O操作を実装